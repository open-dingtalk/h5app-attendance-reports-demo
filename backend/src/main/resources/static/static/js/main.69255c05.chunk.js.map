{"version":3,"sources":["List.js","App.js","index.js"],"names":["date7ago","moment","subtract","format","columns","title","dataIndex","key","render","text","sessionStorage","userId","columnList","columnVals","map","item","date","value","List","props","getAttendanceIntelligenceReports","getItem","setState","state","items","axios","get","domain","then","response","ListItem","data","catch","error","console","log","message","getAttendanceReports","attendanceResultList","isLoaded","alert","JSON","stringify","className","onClick","this","type","length","dataSource","style","overflowX","React","Component","dd","corpId","fetch","res","json","result","permission","requestAuthCode","onSuccess","code","setItem","userid","deptIdList","onFail","err","App","src","alt","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.69255c05.chunk.js","sourcesContent":["import React from \"react\"\nimport axios from \"axios\"\nimport { Button, Table } from \"antd\"\nimport { domain } from \"./App\"\nimport moment from \"moment\"\n\nconst buttonStyle = {\n  height: \"60px\",\n  margin: \"10px\",\n  padding: \"10px\",\n  fontsize: \"18px\",\n}\nconst date7ago = moment().subtract(7, \"days\").format(\"YYYY-MM-DD\")\n// class TrData extends React.Component {\n//   constructor(props) {\n//     super(props)\n//   }\n\n//   render() {\n//     return this.props.items.map((item) => {\n//       const checkType = item.checkType\n//       const userAddress = item.userAddress\n//       const userCheckTime = item.userCheckTime\n//       return (\n//         <tr>\n//           <td>{sessionStorage.userId}</td>\n//           <td>{checkType}</td>\n//           <td>{userAddress}</td>\n//           <td>{userCheckTime}</td>\n//         </tr>\n//       )\n//     })\n//   }\n// }\n\nconst columns = [\n  {\n    title: \"用户\",\n    dataIndex: \"userId\",\n    key: \"userId\",\n    render: (text) => sessionStorage.userId,\n  },\n  {\n    title: \"打卡类型\",\n    dataIndex: \"checkType\",\n    key: \"checkType\",\n  },\n  {\n    title: \"打卡地址\",\n    dataIndex: \"userAddress\",\n    key: \"userAddress\",\n  },\n  {\n    title: \"打卡时间\",\n    dataIndex: \"userCheckTime\",\n    key: \"userCheckTime\",\n  },\n]\nconst columnList = [\n  {\n    title: \"id\",\n    dataIndex: \"id\",\n    key: \"id\",\n  },\n  {\n    title: \"名称\",\n    dataIndex: \"name\",\n    key: \"name\",\n  },\n\n  {\n    title: \"详细记录\",\n    dataIndex: \"columnVals\",\n    key: \"columnVals\",\n    render: (columnVals) => {\n      return columnVals.map((item) => {\n        return (\n          <p>\n            日期：{moment(item.date).format(\"YYYY-MM-DD HH:MM:SS\")} --{\" \"}\n            {item.value}\n          </p>\n        )\n      })\n    },\n  },\n]\n\nclass List extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      items: [],\n      ListItem: [],\n      isLoaded: false,\n    }\n  }\n\n  getAttendanceIntelligenceReports = () => {\n    // 获取存储的用户ID\n    const userId = sessionStorage.getItem(\"userId\")\n    // demo直接构建了要请求的数据，实际开发需要从页面获取\n\n    this.setState({\n      ...this.state,\n      items: [],\n    })\n    // 获取用户考勤智能统计信息\n    axios\n      .get(\n        domain +\n          \"/attendance/intelligence?userId=\" +\n          userId +\n          \"&fromDate=\" +\n          date7ago +\n          \"&toDate=\" +\n          moment().format(\"YYYY-MM-DD\")\n      )\n      .then((response) => {\n        this.setState({\n          ...this.state,\n          ListItem: response.data.data,\n        })\n      })\n      .catch((error) => {\n        // alert(JSON.stringify(error))\n        console.log(error.message)\n      })\n  }\n\n  getAttendanceReports = () => {\n    this.setState({\n      ...this.state,\n      ListItem: [],\n    })\n    // 获取存储的用户ID\n    const userId = sessionStorage.getItem(\"userId\")\n    // demo直接构建了要请求的数据，实际开发需要从页面获取\n    // 获取用户考勤信息\n    axios\n      .get(domain + \"/attendance?userId=\" + userId + \"&workDate=\" + date7ago)\n      .then((response) => {\n        this.setState({\n          items: response.data.data.attendanceResultList,\n          isLoaded: true,\n        })\n        // console.log(response)\n      })\n      .catch((error) => {\n        alert(JSON.stringify(error))\n        // console.log(error.message)\n      })\n  }\n\n  render() {\n    return (\n      <div className=\"btn\">\n        <p>\n          <Button onClick={this.getAttendanceReports} type=\"primary\">\n            获取7天内用户考勤信息\n          </Button>\n        </p>\n        <p>\n          <Button\n            type=\"primary\"\n            onClick={this.getAttendanceIntelligenceReports}\n          >\n            获取用户智能考勤统计信息\n          </Button>\n        </p>\n        {this.state.items?.length > 0 && (\n          <Table\n            columns={columns}\n            dataSource={this.state.items}\n            style={{ overflowX: \"scroll\" }}\n          />\n        )}\n        {this.state.ListItem?.length > 0 && (\n          <Table\n            columns={columnList}\n            dataSource={this.state.ListItem}\n            style={{ overflowX: \"scroll\" }}\n          />\n        )}\n        {/* <table>\n          <thead>\n            <tr>\n              <th>用户</th>\n              <th>打卡类型</th>\n              <th>打卡地址</th>\n              <th>打卡时间</th>\n            </tr>\n          </thead>\n          <tbody>\n            <TrData items={this.state.items} />\n          </tbody>\n        </table> */}\n      </div>\n    )\n  }\n}\n\nexport default List\n","import \"./App.css\"\nimport axios from \"axios\"\nimport * as dd from \"dingtalk-jsapi\"\nimport List from \"./List\"\n\n//内网穿透工具介绍:\n// https://developers.dingtalk.com/document/resourcedownload/http-intranet-penetration?pnamespace=app\n// 替换成后端服务域名\nexport const domain = \"\"\nfunction App() {\n  return (\n    <div className=\"content\">\n      <div className=\"header\">\n        <img\n          src=\"https://img.alicdn.com/imgextra/i3/O1CN01Mpftes1gwqxuL0ZQE_!!6000000004207-2-tps-240-240.png\"\n          className=\"headImg\"\n          alt=\"\"\n        />\n        钉钉模板\n      </div>\n      <div className=\"App\">\n        <List />\n      </div>\n    </div>\n  )\n}\n\ndd.ready(function () {\n  // let corpId;\n  // axios.get(domain + \"/config\")\n  //     .then(response => {\n  //         corpId = response.data.corpId;\n  //     })\n  //     .catch(error => {\n  //         alert(JSON.stringify(error))\n  //         // console.log(error.message)\n  //     })\n  let corpId\n  fetch(domain + \"/config\")\n    .then((res) => res.json())\n    .then((result) => {\n      // alert(JSON.stringify(result));\n      corpId = result.data.corpId\n      // dd.ready参数为回调函数，在环境准备就绪时触发，jsapi的调用需要保证在该回调函数触发后调用，否则无效。\n      dd.runtime.permission.requestAuthCode({\n        corpId: corpId, //三方企业ID\n        onSuccess: function (result) {\n          // alert(JSON.stringify(result));\n          axios\n            .get(domain + \"/login?authCode=\" + result.code)\n            .then((response) => {\n              // alert(JSON.stringify(response));\n              // alert(JSON.stringify(response.data));\n              // alert(JSON.stringify(response.data.data.userid));\n              // alert(JSON.stringify(response.data.data.deptIdList[0]));\n              // 登录成功后储存用户部门和ID\n              sessionStorage.setItem(\"userId\", response.data.data.userid)\n              sessionStorage.setItem(\"deptId\", response.data.data.deptIdList[0])\n            })\n            .catch((error) => {\n              alert(JSON.stringify(error))\n              // console.log(error.message)\n            })\n        },\n        onFail: function (err) {\n          alert(JSON.stringify(err))\n        },\n      })\n    })\n})\n\nexport default App\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport \"./index.css\"\nimport App from \"./App\"\nimport \"antd/dist/antd.min.css\"\n\nReactDOM.render(\n  // <React.StrictMode>\n  <App />,\n  // </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals()\n"],"sourceRoot":""}